<!DOCTYPE html>
<html lang="pt"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/LayoutPadrao}">

<body>

<!-- =========================================================
     CONTEÚDO PRINCIPAL
========================================================== -->
<section layout:fragment="conteudo">

    <div class="container-fluid mt-4">

        <!-- =================================================
             TÍTULO
        ================================================== -->
        <h1 class="mb-4">Listagem de Cervejas</h1>

        <!-- =================================================
             FILTRO
        ================================================== -->
        <form method="get" class="row g-3 mb-4">

            <div class="col-md-4">
                <input type="text"
                       name="nome"
                       class="form-control"
                       placeholder="Nome da cerveja"
                       th:value="${filtro.nome}">
            </div>

            <div class="col-md-4">
                <select name="estilo" class="form-select">
                    <option value="">Todos os estilos</option>
                    <option th:each="e : ${estilos}"
                            th:value="${e.id}"
                            th:selected="${filtro.estilo != null and e.id == filtro.estilo}"
                            th:text="${e.nome}">
                    </option>
                </select>
            </div>

            <div class="col-md-2">
                <button class="btn btn-primary w-100">
                    Filtrar
                </button>
            </div>
        </form>

        <!-- =================================================
             TABELA
        ================================================== -->
        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">

                <thead class="table-dark">
                <tr>
                    <th>SKU</th>
                    <th>Nome</th>
                    <th>Estilo</th>
                    <th>Valor</th>
                    <th>Estoque</th>
                    <th class="text-center">Ações</th>
                </tr>
                </thead>

                <tbody>

                <tr th:each="cerveja : ${page.content}">
                    <td th:text="${cerveja.sku}"></td>
                    <td th:text="${cerveja.nome}"></td>
                    <td th:text="${cerveja.estilo.nome}"></td>
                    <td th:text="${#numbers.formatDecimal(cerveja.valor,1,'POINT',2,'COMMA')}"></td>
                    <td th:text="${cerveja.quantidadeEstoque}"></td>

                    <td class="text-center">

                        <!-- EDITAR -->
                        <a class="btn btn-sm btn-outline-primary"
                           th:href="@{/cervejas/{id}(id=${cerveja.id})}">
                            <i class="fa fa-edit"></i>
                            Editar
                        </a>

                        <!-- EXCLUIR (MODAL) -->
                        <button type="button"
                                class="btn btn-sm btn-outline-danger"
                                data-bs-toggle="modal"
                                data-bs-target="#modalExcluir"
                                th:attr="data-id=${cerveja.id}, data-nome=${cerveja.nome}">
                            <i class="fa fa-trash"></i>
							<span class="d-none d-md-inline"> Excluir</span>
                            
                        </button>

                    </td>
                </tr>

                <tr th:if="${page.totalElements == 0}">
                    <td colspan="6" class="text-center text-muted">
                        Nenhuma cerveja cadastrada.
                    </td>
                </tr>

                </tbody>
            </table>
        </div>

        <!-- =================================================
             PAGINAÇÃO
        ================================================== -->
        <nav th:if="${page.totalPages > 1}">
            <ul class="pagination">

                <li class="page-item" th:classappend="${page.first} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/cervejas(page=${page.number - 1}, nome=${filtro.nome}, estilo=${filtro.estilo})}">
                        Anterior
                    </a>
                </li>

                <li class="page-item"
                    th:each="i : ${#numbers.sequence(0, page.totalPages - 1)}"
                    th:classappend="${i == page.number} ? 'active'">
                    <a class="page-link"
                       th:text="${i + 1}"
                       th:href="@{/cervejas(page=${i}, nome=${filtro.nome}, estilo=${filtro.estilo})}">
                    </a>
                </li>

                <li class="page-item" th:classappend="${page.last} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/cervejas(page=${page.number + 1}, nome=${filtro.nome}, estilo=${filtro.estilo})}">
                        Próximo
                    </a>
                </li>

            </ul>
        </nav>

    </div>

    <!-- =========================================================
         MODAL DE EXCLUSÃO
    ========================================================== -->
    <form id="formExcluir" method="post">
        <div class="modal fade" id="modalExcluir" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">

                    <div class="modal-header">
                        <h5 class="modal-title">Confirmar exclusão</h5>
                        <button type="button" class="btn-close"
                                data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body">
                        Tem certeza que deseja excluir a cerveja
                        <strong id="nomeCerveja"></strong>?
                    </div>

                    <div class="modal-footer">
                        <button type="button"
                                class="btn btn-secondary"
                                data-bs-dismiss="modal">
                            Cancelar
                        </button>
                        <button type="submit" class="btn btn-danger">
                            Excluir
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </form>

    <!-- =========================================================
         SCRIPT (DENTRO DO FRAGMENTO)
    ========================================================== -->
    <script th:src="@{/js/listar-cervejas.js}"></script>
    <script th:src="@{/js/cervejas.js}"></script>

</section>

</body>
</html>
