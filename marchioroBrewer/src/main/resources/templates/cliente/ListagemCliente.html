<!DOCTYPE html>
<html lang="pt"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/LayoutPadrao}">

<body>

<div th:if="${mensagemSucesso}" 
     class="alert alert-success alert-dismissible fade show">

    <span th:text="${mensagemSucesso}"></span>

    <button type="button" 
            class="btn-close" 
            data-bs-dismiss="alert"></button>
</div>

<!-- =========================================================
     CONTEÚDO PRINCIPAL
========================================================== -->
<section layout:fragment="conteudo">

    <div class="container-fluid mt-4">

        <!-- =================================================
             TÍTULO
        ================================================== -->
        <h1 class="mb-4">Listagem de Clientes</h1>

        <!-- =================================================
             FORMULÁRIO DE FILTRO
        ================================================== -->
        <form method="get" class="row g-3 mb-4">

           
            <div class="col-md-4">
                <input type="text"
                       name="nomeCliente"
                       th:value="${nomeCliente}"
                       class="form-control"
                       placeholder="Nome do cliente">
            </div>

            <!-- Botão filtrar -->
            <div class="col-md-2">
                <button class="btn btn-outline-primary w-100">
                    Filtrar
                </button>
            </div>

        </form>

        <!-- =================================================
             TABELA DE CLIENTES
        ================================================== -->
        <div class="table-responsive">
            <table class="table table-striped table-hover">

                <thead class="table-dark">
                <tr class="text-center">
                    <th>Nome</th>
                    <th>CPF/CNPJ</th>
                    <th>Telefone</th>
                    <th>Email</th>
                    <th>Cidade</th>
                    <th>Ações</th>
                </tr>
                </thead>

                <tbody>

                <!-- Percorre página -->
                <tr class="text-center"
                    th:each="cliente : ${page.content}">

                    <!-- Nome -->
                    <td th:text="${cliente.nomeCliente}"></td>

                    <!-- Documento (vamos aplicar máscara depois via JS) -->
                    <td class="documento"
                        th:text="${cliente.documento}">
                    </td>

                    <!-- Telefone (máscara depois via JS) -->
                    <td class="telefone"
                        th:text="${cliente.telefone}">
                    </td>

                    <!-- Email -->
                    <td th:text="${cliente.email}"></td>

                    <!-- Cidade -->
                    <td th:text="${cliente.endereco.cidade.nomeCidade}"></td>

                    <!-- AÇÕES -->
                    <td>

                        <!-- ======================================
                             EDITAR
                        ======================================= -->
                        <a th:href="@{/clientes/editar/{id}(id=${cliente.id})}"
                           class="btn btn-sm btn-outline-primary">
                            <i class="fa fa-edit"></i> Editar
                        </a>

                        <!-- ======================================
                             SOFT DELETE
                        ======================================= -->
                        
                         <!-- EXCLUIR (MODAL) -->
                        <button type="button"
                                class="btn btn-sm btn-outline-danger"
                                data-bs-toggle="modal"
                                data-bs-target="#modalExcluir"
                                th:attr="data-id=${cliente.id}, data-nome=${cliente.nomeCliente}">
                            <i class="fa fa-trash"></i>
							<span class="d-none d-md-inline"> Excluir</span>
                            
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- =================================================
             PAGINAÇÃO
        ================================================== -->
        <nav th:if="${page.totalPages > 1}">
            <ul class="pagination">

                <li class="page-item"
                    th:classappend="${page.first} ? 'disabled'">

                    <a class="page-link"
                       th:href="@{/clientes(page=${page.number - 1}, nomeCliente=${nomeCliente})}">
                        Anterior
                    </a>
                </li>

                <li class="page-item"
                    th:each="i : ${#numbers.sequence(0, page.totalPages - 1)}"
                    th:classappend="${i == page.number} ? 'active'">

                    <a class="page-link"
                       th:href="@{/clientes(page=${i}, nomeCliente=${nomeCliente})}"
                       th:text="${i + 1}">
                    </a>
                </li>

                <li class="page-item"
                    th:classappend="${page.last} ? 'disabled'">

                    <a class="page-link"
                       th:href="@{/clientes(page=${page.number + 1}, nomeCliente=${nomeCliente})}">
                        Próxima
                    </a>
                </li>

            </ul>
        </nav>

    </div>
    
    <!-- =========================================================
         MODAL DE EXCLUSÃO
    ========================================================== -->
    <form id="formExcluir" method="post">
        <div class="modal fade" id="modalExcluir" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">

                    <div class="modal-header">
                        <h5 class="modal-title">Confirmar exclusão</h5>
                        <button type="button" class="btn-close"
                                data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body">
                        Tem certeza que deseja excluir o cliente
                        <strong id="nomeCliente"></strong>?
                    </div>

                    <div class="modal-footer">
                        <button type="button"
                                class="btn btn-secondary"
                                data-bs-dismiss="modal">
                            Cancelar
                        </button>
                        <button type="submit" class="btn btn-danger">
                            Excluir
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </form>
    
     <!-- =========================================================
         SCRIPT (DENTRO DO FRAGMENTO)
    ========================================================== -->
    <script th:src="@{/js/modal-excluir-cliente.js}"></script>
</section>
</body>
</html>
